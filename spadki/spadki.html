<p *ngIf="!externalgrid"><em>Loading External Grids Details please Wait ! ...</em></p>
<button type="button" class="btn btn-primary" (click)=AddExtGrid() *ngIf="createButton"> 
    Create
    </button>


<table class="table" *ngIf="AddExtGridTable" [@fadeIn]='animStatus'>
    <thead>
        <tr>
            <th>Name</th>
            <th>No. of node</th>
            <th>Type of node</th>
            <th>Voltage angle [deg]</th>
            <th>Voltage setpoint [p.u.]</th>
            <th>Active power [MW]</th>
            <th>Reactive power [MVAr]</th>
            <th>ID</th>
        </tr>
    </thead>

    <tbody>
        <tr>

            <td><input type="text" #Name (ngModel)="Names" value="{{Names}}"></td>
            <td><input type="text" #NodeNo (ngModel)="NodeNos" value="{{NodeNos}}"></td>
            <td><input type="text" #NodeType (ngModel)="NodeTypes" value="{{NodeTypes}}"></td>
            <td><input type="text" #VoltageAngle (ngModel)="VoltageAngles" value="{{VoltageAngles}}"></td>
            <td><input type="text" #VoltageSetpoint (ngModel)="VoltageSetpoints" value="{{VoltageSetpoints}}"></td>
            <td><input type="text" #ActivePower (ngModel)="ActivePowers" value="{{ActivePowers}}"></td>
            <td><input type="text" #ReactivePower (ngModel)="ReactivePowers" value="{{ReactivePowers}}"></td>
            <td><input type="text" #ID (ngModel)="IDs" value="{{IDs}}" style="background-color:tan" readonly></td>
        </tr>
        <td>
            <button (click)=addExtGridDetails(ID.value,Name.value,NodeNo.value,NodeType.value,VoltageAngle.value,VoltageSetpoint.value,ActivePower.value,ReactivePower.value)
                [@moveBottom]='animStatus'>  
                                   Save
                               </button>
        </td>
        <td>
            <button (click)=closeEdits() [@moveTop]='animStatus'>  
                                   Close
                               </button>
        </td>
    </tbody>
</table>



<table class="table" *ngIf="externalgrid">

    <thead>
        <tr>
            <th></th>
            <th></th>
            <th>Name</th>
            <th>No. of node</th>
            <th>Type of node</th>
            <th>Voltage angle [deg]</th>
            <th>Voltage setpoint [p.u.]</th>
            <th>Active power [MW]</th>
            <th>Reactive power [MVAr]</th>
        </tr>
    </thead>

    <tbody *ngFor="let ExternalGrids  of externalgrid">
        <tr>
            <td>
                <button type="button" class="btn btn-primary" (click)=editExtGridDetails(ExternalGrids.id,ExternalGrids.name,ExternalGrids.nodeNo,ExternalGrids.nodeType,ExternalGrids.voltageAngle,ExternalGrids.voltageSetpoint,ExternalGrids.activePower,ExternalGrids.reactivePower)>Edit</button></td>


            <td>
                <button type="button" class="btn btn-danger" (click)=deleteExtGridDetails(ExternalGrids.id)>Delete</button>

            </td>

            <td>{{ExternalGrids.name}}</td>
            <td>{{ExternalGrids.nodeNo}}</td>
            <td>{{ExternalGrids.nodeType}}</td>
            <td>{{ExternalGrids.voltageAngle}}</td>
            <td>{{ExternalGrids.voltageSetpoint}}</td>
            <td>{{ExternalGrids.activePower}}</td>
            <td>{{ExternalGrids.reactivePower}}</td>
        </tr>
    </tbody>
</table>


<table class="table" *ngIf="AddExtGridTable" [@fadeIn]='animStatus'>
        <thead>
            <tr>
                <th>Name</th>
                <th>No. of node</th>
                <th>Type of node</th>
                <th>Voltage angle [deg]</th>
                <th>Voltage setpoint [p.u.]</th>
                <th>Active power [MW]</th>
                <th>Reactive power [MVAr]</th>
                <th>ID</th>
            </tr>
        </thead>
    
        <tbody>
            <tr>
    
                <td><input type="text" #Name (ngModel)="Names" value="{{Names}}"></td>
                <td><input type="text" #NodeNo (ngModel)="NodeNos" value="{{NodeNos}}"></td>
                <td><input type="text" #NodeType (ngModel)="NodeTypes" value="{{NodeTypes}}"></td>
                <td><input type="text" #VoltageAngle (ngModel)="VoltageAngles" value="{{VoltageAngles}}"></td>
                <td><input type="text" #VoltageSetpoint (ngModel)="VoltageSetpoints" value="{{VoltageSetpoints}}"></td>
                <td><input type="text" #ActivePower (ngModel)="ActivePowers" value="{{ActivePowers}}"></td>
                <td><input type="text" #ReactivePower (ngModel)="ReactivePowers" value="{{ReactivePowers}}"></td>
                <td><input type="text" #ID (ngModel)="IDs" value="{{IDs}}" style="background-color:tan" readonly></td>
            </tr>
            <td>
                <button (click)=addExtGridDetails(ID.value,Name.value,NodeNo.value,NodeType.value,VoltageAngle.value,VoltageSetpoint.value,ActivePower.value,ReactivePower.value)
                    [@moveBottom]='animStatus'>  
                                       Save
                                   </button>
            </td>
            <td>
                <button (click)=closeEdits() [@moveTop]='animStatus'>  
                                       Close
                                   </button>
            </td>
        </tbody>
    </table>
    
    <ag-grid-angular #agGrid style="width: 1400px; height: 200px;"  class="ag-bootstrap" 
    [gridOptions]="gridOptions"
    [rowData]="rowData"
    [columnDefs]="columnDefs"
    [defaultColDef]="defaultColDef">
    </ag-grid-angular>
    
    
    
    
    
    
    
    <p *ngIf="!externalgrid"><em>Loading External Grids Details please Wait ! ...</em></p>
    <button type="button" class="btn btn-primary" (click)=AddExtGrid() *ngIf="createButton"> 
    Create
    </button>
    
    
    
    
    
    <table class="table" *ngIf="externalgrid">
    
    <thead>
        <tr>
            <th></th>
            <th></th>
            <th>Name</th>
            <th>No. of node</th>
            <th>Type of node</th>
            <th>Voltage angle [deg]</th>
            <th>Voltage setpoint [p.u.]</th>
            <th>Active power [MW]</th>
            <th>Reactive power [MVAr]</th>
        </tr>
    </thead>
    
    <tbody *ngFor="let ExternalGrids  of externalgrid">
        <tr>
            <td>
                <button type="button" class="btn btn-primary" (click)=editExtGridDetails(ExternalGrids.id,ExternalGrids.name,ExternalGrids.nodeNo,ExternalGrids.nodeType,ExternalGrids.voltageAngle,ExternalGrids.voltageSetpoint,ExternalGrids.activePower,ExternalGrids.reactivePower)>Edit</button></td>
    
    
            <td>
                <button type="button" class="btn btn-danger" (click)=deleteExtGridDetails(ExternalGrids.id)>Delete</button>
    
            </td>
    
            <td>{{ExternalGrids.name}}</td>
            <td>{{ExternalGrids.nodeNo}}</td>
            <td>{{ExternalGrids.nodeType}}</td>
            <td>{{ExternalGrids.voltageAngle}}</td>
            <td>{{ExternalGrids.voltageSetpoint}}</td>
            <td>{{ExternalGrids.activePower}}</td>
            <td>{{ExternalGrids.reactivePower}}</td>
        </tr>
    </tbody>
    </table>
    

    <table class="table" *ngIf="AddExtGridTable" [@fadeIn]='animStatus'>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>No. of node</th>
                    <th>Type of node</th>
                    <th>Voltage angle [deg]</th>
                    <th>Voltage setpoint [p.u.]</th>
                    <th>Active power [MW]</th>
                    <th>Reactive power [MVAr]</th>
                    <th>ID</th>
                </tr>
            </thead>
    
            <tbody>
                <tr>
    
                    <td><input type="text" #Name (ngModel)="Names" value="{{Names}}"></td>
                    <td><input type="text" #NodeNo (ngModel)="NodeNos" value="{{NodeNos}}"></td>
                    <td><input type="text" #NodeType (ngModel)="NodeTypes" value="{{NodeTypes}}"></td>
                    <td><input type="text" #VoltageAngle (ngModel)="VoltageAngles" value="{{VoltageAngles}}"></td>
                    <td><input type="text" #VoltageSetpoint (ngModel)="VoltageSetpoints" value="{{VoltageSetpoints}}"></td>
                    <td><input type="text" #ActivePower (ngModel)="ActivePowers" value="{{ActivePowers}}"></td>
                    <td><input type="text" #ReactivePower (ngModel)="ReactivePowers" value="{{ReactivePowers}}"></td>
                    <td><input type="text" #ID (ngModel)="IDs" value="{{IDs}}" style="background-color:tan" readonly></td>
                </tr>
                <td>
                    <button (click)=addExtGridDetails(ID.value,Name.value,NodeNo.value,NodeType.value,VoltageAngle.value,VoltageSetpoint.value,ActivePower.value,ReactivePower.value)
                        [@moveBottom]='animStatus'>
                                               Save
                                           </button>
                </td>
                <td>
                    <button (click)=closeEdits() [@moveTop]='animStatus'>
                                               Close
                                           </button>
                </td>
            </tbody>
        </table>


        <!DOCTYPE html>
        <html>
        <head>
            <meta charset="utf-8" />
            <title></title>
        </head>
        <body>
            <p *ngIf="!loadflow"><em>Loading Load Flow results please Wait ! ...</em></p>
        
            <table class='table' *ngIf="loadflow">
                <thead>
                    <tr>                
                        <th>No. of node</th>
                        <th>Voltage</th>
                        <th>Voltage angle</th>              
                    </tr>
                </thead>
        
                <tbody>
                    <tr *ngFor="let LoadFlow  of loadflow">
                        <td>{{LoadFlow.busNo}}</td>
                        <td>{{LoadFlow.resultU}}</td>
                        <td>{{LoadFlow.resultSigma}}</td>  
                    </tr>
                </tbody>
            </table>
        </body>
        </html>
        